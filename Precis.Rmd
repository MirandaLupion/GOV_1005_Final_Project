---
title: "Precis"
author: "Miranda Lupion"
date: "10/16/2018"
output: html_document
---

```{r setup, include=FALSE, warning=FALSE, echo=FALSE, error=FALSE, message=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(knitr)
library(stringr)
```

#Objective 
This project aims to visualize two decades (1990 - 2010) of data on 83 of the 85 federal subjects of the Russian Federation. I hope to use Leaflet to create maps that allow users to click on individual regions and display popups with information, as well as to visualize certain indicators geospatially. I also plan to create a ShinyApp that lets users select regions and indicators to visualize over time.   

*****

#Data
I am drawing on data from the Inter-university Consortium for Political and Social Research (ICPSR). The dataset is ICPSR 35355 "Aggregate Data, Regions of Russia (RoR), 1990 - 2010" created by Irina Mirkina. The data actually consists of 13 individual files each containing anywhere from a dozen to two hundred variables. From these sets, I plan to pull 25 - 30 variables and create a smaller data set, which I will use for this project.   

*****

#Summary statistics and example
I have loaded the Regions 4 data set, which includes 22 indicators on crime and 1,722 observations. They say that Russia is notorius for its дураки и дороги - its idiots and its roads. Examing the ROADACCIDENT variable (number of accidents per 100,000 people), we can graph the mean accidents for each year across the Russian Federation.   

My ShinyApp will (hopefully) allow users to select indicators and create these sorts of visualizations.   

```{r, warning=FALSE, echo=FALSE, error=FALSE, message=FALSE}
load("Regions4.rda")
r_4 <- da35355.0004


r_4$REGION <- str_trim(r_4$REGION)

accident <- r_4 %>%
  select(YEAR, ROADACCIDENT, REGION) %>%
  group_by(YEAR) %>%
  filter(!is.na(ROADACCIDENT)) %>%
  summarise(mean_accident = mean(ROADACCIDENT))

ggplot(accident, aes(x = YEAR, y = mean_accident)) +
  geom_line() +
  labs(x = "Year", 
       y = "Average road accidents (per 100,000 people)", 
       title = "Road accidents have picked up since 2000")
```

*****

The five regions with the highest accident rates for 2010 are shown below. Lets see how their accident rates have or have not changed over time.  

```{r, warning=FALSE, echo=FALSE, error=FALSE, message=FALSE}
top_5 <- r_4 %>%
  select(YEAR, NAME, REGION, ROADACCIDENT) %>%
 filter(YEAR == "2010") %>%
  arrange(desc(ROADACCIDENT)) %>%
  slice(1:5)

top_5 %>%
  select(NAME, ROADACCIDENT) %>%
  kable(col.names = c("Region", "Road accidents per 100,000 people"))
```
  

```{r, warning=FALSE, echo=FALSE, error=FALSE, message=FALSE}
r_4 %>%
  select(YEAR, ROADACCIDENT, REGION, NAME) %>%
  filter(REGION %in% c(top_5$REGION)) %>%
ggplot(aes(x = YEAR, y = ROADACCIDENT, color = NAME)) +
  geom_line() +
  labs(x = "Year",
       y = "Average road accidents (per 100,000 people)",
       title = "Accident rates over time",
       subtitle = "For regions with highest rates in 2010")
```

This is messy and there is missing data, but this gives you an idea of what I'd like my users to be able to visualize with Shiny. 
